{"ast":null,"code":"import _classCallCheck from \"/home/jay/Downloads/major/my-app/gis/web-gis/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/jay/Downloads/major/my-app/gis/web-gis/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/home/jay/Downloads/major/my-app/gis/web-gis/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _get from \"/home/jay/Downloads/major/my-app/gis/web-gis/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/home/jay/Downloads/major/my-app/gis/web-gis/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/home/jay/Downloads/major/my-app/gis/web-gis/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/home/jay/Downloads/major/my-app/gis/web-gis/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\n/**\n * @module ol/TileQueue\n */\nimport EventType from './events/EventType.js';\nimport PriorityQueue, { DROP } from './structs/PriorityQueue.js';\nimport TileState from './TileState.js';\n\n/**\n * @typedef {function(import(\"./Tile.js\").default, string, import(\"./coordinate.js\").Coordinate, number): number} PriorityFunction\n */\nvar TileQueue = /*#__PURE__*/function (_PriorityQueue) {\n  _inherits(TileQueue, _PriorityQueue);\n  var _super = _createSuper(TileQueue);\n  /**\n   * @param {PriorityFunction} tilePriorityFunction Tile priority function.\n   * @param {function(): ?} tileChangeCallback Function called on each tile change event.\n   */\n  function TileQueue(tilePriorityFunction, tileChangeCallback) {\n    var _this;\n    _classCallCheck(this, TileQueue);\n    _this = _super.call(this,\n    /**\n     * @param {Array} element Element.\n     * @return {number} Priority.\n     */\n    function (element) {\n      return tilePriorityFunction.apply(null, element);\n    },\n    /**\n     * @param {Array} element Element.\n     * @return {string} Key.\n     */\n    function (element) {\n      return (/** @type {import(\"./Tile.js\").default} */element[0].getKey()\n      );\n    });\n\n    /** @private */\n    _this.boundHandleTileChange_ = _this.handleTileChange.bind(_assertThisInitialized(_this));\n\n    /**\n     * @private\n     * @type {function(): ?}\n     */\n    _this.tileChangeCallback_ = tileChangeCallback;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.tilesLoading_ = 0;\n\n    /**\n     * @private\n     * @type {!Object<string,boolean>}\n     */\n    _this.tilesLoadingKeys_ = {};\n    return _this;\n  }\n\n  /**\n   * @param {Array} element Element.\n   * @return {boolean} The element was added to the queue.\n   */\n  _createClass(TileQueue, [{\n    key: \"enqueue\",\n    value: function enqueue(element) {\n      var added = _get(_getPrototypeOf(TileQueue.prototype), \"enqueue\", this).call(this, element);\n      if (added) {\n        var tile = element[0];\n        tile.addEventListener(EventType.CHANGE, this.boundHandleTileChange_);\n      }\n      return added;\n    }\n\n    /**\n     * @return {number} Number of tiles loading.\n     */\n  }, {\n    key: \"getTilesLoading\",\n    value: function getTilesLoading() {\n      return this.tilesLoading_;\n    }\n\n    /**\n     * @param {import(\"./events/Event.js\").default} event Event.\n     * @protected\n     */\n  }, {\n    key: \"handleTileChange\",\n    value: function handleTileChange(event) {\n      var tile = /** @type {import(\"./Tile.js\").default} */event.target;\n      var state = tile.getState();\n      if (state === TileState.LOADED || state === TileState.ERROR || state === TileState.EMPTY) {\n        if (state !== TileState.ERROR) {\n          tile.removeEventListener(EventType.CHANGE, this.boundHandleTileChange_);\n        }\n        var tileKey = tile.getKey();\n        if (tileKey in this.tilesLoadingKeys_) {\n          delete this.tilesLoadingKeys_[tileKey];\n          --this.tilesLoading_;\n        }\n        this.tileChangeCallback_();\n      }\n    }\n\n    /**\n     * @param {number} maxTotalLoading Maximum number tiles to load simultaneously.\n     * @param {number} maxNewLoads Maximum number of new tiles to load.\n     */\n  }, {\n    key: \"loadMoreTiles\",\n    value: function loadMoreTiles(maxTotalLoading, maxNewLoads) {\n      var newLoads = 0;\n      var state, tile, tileKey;\n      while (this.tilesLoading_ < maxTotalLoading && newLoads < maxNewLoads && this.getCount() > 0) {\n        tile = /** @type {import(\"./Tile.js\").default} */this.dequeue()[0];\n        tileKey = tile.getKey();\n        state = tile.getState();\n        if (state === TileState.IDLE && !(tileKey in this.tilesLoadingKeys_)) {\n          this.tilesLoadingKeys_[tileKey] = true;\n          ++this.tilesLoading_;\n          ++newLoads;\n          tile.load();\n        }\n      }\n    }\n  }]);\n  return TileQueue;\n}(PriorityQueue);\nexport default TileQueue;\n\n/**\n * @param {import('./Map.js').FrameState} frameState Frame state.\n * @param {import(\"./Tile.js\").default} tile Tile.\n * @param {string} tileSourceKey Tile source key.\n * @param {import(\"./coordinate.js\").Coordinate} tileCenter Tile center.\n * @param {number} tileResolution Tile resolution.\n * @return {number} Tile priority.\n */\nexport function getTilePriority(frameState, tile, tileSourceKey, tileCenter, tileResolution) {\n  // Filter out tiles at higher zoom levels than the current zoom level, or that\n  // are outside the visible extent.\n  if (!frameState || !(tileSourceKey in frameState.wantedTiles)) {\n    return DROP;\n  }\n  if (!frameState.wantedTiles[tileSourceKey][tile.getKey()]) {\n    return DROP;\n  }\n  // Prioritize the highest zoom level tiles closest to the focus.\n  // Tiles at higher zoom levels are prioritized using Math.log(tileResolution).\n  // Within a zoom level, tiles are prioritized by the distance in pixels between\n  // the center of the tile and the center of the viewport.  The factor of 65536\n  // means that the prioritization should behave as desired for tiles up to\n  // 65536 * Math.log(2) = 45426 pixels from the focus.\n  var center = frameState.viewState.center;\n  var deltaX = tileCenter[0] - center[0];\n  var deltaY = tileCenter[1] - center[1];\n  return 65536 * Math.log(tileResolution) + Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution;\n}","map":{"version":3,"names":["EventType","PriorityQueue","DROP","TileState","TileQueue","_PriorityQueue","_inherits","_super","_createSuper","tilePriorityFunction","tileChangeCallback","_this","_classCallCheck","call","element","apply","getKey","boundHandleTileChange_","handleTileChange","bind","_assertThisInitialized","tileChangeCallback_","tilesLoading_","tilesLoadingKeys_","_createClass","key","value","enqueue","added","_get","_getPrototypeOf","prototype","tile","addEventListener","CHANGE","getTilesLoading","event","target","state","getState","LOADED","ERROR","EMPTY","removeEventListener","tileKey","loadMoreTiles","maxTotalLoading","maxNewLoads","newLoads","getCount","dequeue","IDLE","load","getTilePriority","frameState","tileSourceKey","tileCenter","tileResolution","wantedTiles","center","viewState","deltaX","deltaY","Math","log","sqrt"],"sources":["/home/jay/Downloads/major/my-app/gis/web-gis/node_modules/ol/TileQueue.js"],"sourcesContent":["/**\n * @module ol/TileQueue\n */\nimport EventType from './events/EventType.js';\nimport PriorityQueue, {DROP} from './structs/PriorityQueue.js';\nimport TileState from './TileState.js';\n\n/**\n * @typedef {function(import(\"./Tile.js\").default, string, import(\"./coordinate.js\").Coordinate, number): number} PriorityFunction\n */\n\nclass TileQueue extends PriorityQueue {\n  /**\n   * @param {PriorityFunction} tilePriorityFunction Tile priority function.\n   * @param {function(): ?} tileChangeCallback Function called on each tile change event.\n   */\n  constructor(tilePriorityFunction, tileChangeCallback) {\n    super(\n      /**\n       * @param {Array} element Element.\n       * @return {number} Priority.\n       */\n      function (element) {\n        return tilePriorityFunction.apply(null, element);\n      },\n      /**\n       * @param {Array} element Element.\n       * @return {string} Key.\n       */\n      function (element) {\n        return /** @type {import(\"./Tile.js\").default} */ (element[0]).getKey();\n      }\n    );\n\n    /** @private */\n    this.boundHandleTileChange_ = this.handleTileChange.bind(this);\n\n    /**\n     * @private\n     * @type {function(): ?}\n     */\n    this.tileChangeCallback_ = tileChangeCallback;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.tilesLoading_ = 0;\n\n    /**\n     * @private\n     * @type {!Object<string,boolean>}\n     */\n    this.tilesLoadingKeys_ = {};\n  }\n\n  /**\n   * @param {Array} element Element.\n   * @return {boolean} The element was added to the queue.\n   */\n  enqueue(element) {\n    const added = super.enqueue(element);\n    if (added) {\n      const tile = element[0];\n      tile.addEventListener(EventType.CHANGE, this.boundHandleTileChange_);\n    }\n    return added;\n  }\n\n  /**\n   * @return {number} Number of tiles loading.\n   */\n  getTilesLoading() {\n    return this.tilesLoading_;\n  }\n\n  /**\n   * @param {import(\"./events/Event.js\").default} event Event.\n   * @protected\n   */\n  handleTileChange(event) {\n    const tile = /** @type {import(\"./Tile.js\").default} */ (event.target);\n    const state = tile.getState();\n    if (\n      state === TileState.LOADED ||\n      state === TileState.ERROR ||\n      state === TileState.EMPTY\n    ) {\n      if (state !== TileState.ERROR) {\n        tile.removeEventListener(EventType.CHANGE, this.boundHandleTileChange_);\n      }\n      const tileKey = tile.getKey();\n      if (tileKey in this.tilesLoadingKeys_) {\n        delete this.tilesLoadingKeys_[tileKey];\n        --this.tilesLoading_;\n      }\n      this.tileChangeCallback_();\n    }\n  }\n\n  /**\n   * @param {number} maxTotalLoading Maximum number tiles to load simultaneously.\n   * @param {number} maxNewLoads Maximum number of new tiles to load.\n   */\n  loadMoreTiles(maxTotalLoading, maxNewLoads) {\n    let newLoads = 0;\n    let state, tile, tileKey;\n    while (\n      this.tilesLoading_ < maxTotalLoading &&\n      newLoads < maxNewLoads &&\n      this.getCount() > 0\n    ) {\n      tile = /** @type {import(\"./Tile.js\").default} */ (this.dequeue()[0]);\n      tileKey = tile.getKey();\n      state = tile.getState();\n      if (state === TileState.IDLE && !(tileKey in this.tilesLoadingKeys_)) {\n        this.tilesLoadingKeys_[tileKey] = true;\n        ++this.tilesLoading_;\n        ++newLoads;\n        tile.load();\n      }\n    }\n  }\n}\n\nexport default TileQueue;\n\n/**\n * @param {import('./Map.js').FrameState} frameState Frame state.\n * @param {import(\"./Tile.js\").default} tile Tile.\n * @param {string} tileSourceKey Tile source key.\n * @param {import(\"./coordinate.js\").Coordinate} tileCenter Tile center.\n * @param {number} tileResolution Tile resolution.\n * @return {number} Tile priority.\n */\nexport function getTilePriority(\n  frameState,\n  tile,\n  tileSourceKey,\n  tileCenter,\n  tileResolution\n) {\n  // Filter out tiles at higher zoom levels than the current zoom level, or that\n  // are outside the visible extent.\n  if (!frameState || !(tileSourceKey in frameState.wantedTiles)) {\n    return DROP;\n  }\n  if (!frameState.wantedTiles[tileSourceKey][tile.getKey()]) {\n    return DROP;\n  }\n  // Prioritize the highest zoom level tiles closest to the focus.\n  // Tiles at higher zoom levels are prioritized using Math.log(tileResolution).\n  // Within a zoom level, tiles are prioritized by the distance in pixels between\n  // the center of the tile and the center of the viewport.  The factor of 65536\n  // means that the prioritization should behave as desired for tiles up to\n  // 65536 * Math.log(2) = 45426 pixels from the focus.\n  const center = frameState.viewState.center;\n  const deltaX = tileCenter[0] - center[0];\n  const deltaY = tileCenter[1] - center[1];\n  return (\n    65536 * Math.log(tileResolution) +\n    Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}